{"version":3,"sources":["../src/js/BoundingBox.js"],"names":["throwIfMissing","addClasses","removeClasses","BoundingBox","options","isShowing","namespace","zoomFactor","containerEl","settings","openClasses","_buildClasses","_buildElement","suffix","classes","ns","push","el","document","createElement","zoomPaneWidth","zoomPaneHeight","appendChild","style","width","Math","round","height","removeChild","percentageOffsetX","percentageOffsetY","triggerRect","pageXOffset","window","pageYOffset","inlineLeft","left","clientWidth","inlineTop","top","clientHeight"],"mappings":"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","sourcesContent":["import throwIfMissing from \"./util/throwIfMissing\";\nimport { addClasses, removeClasses } from \"./util/dom\";\n\nexport default class BoundingBox {\n  constructor(options) {\n    this.isShowing = false;\n\n    const { namespace = null, zoomFactor = throwIfMissing(), containerEl = throwIfMissing() } = options;\n\n    this.settings = { namespace, zoomFactor, containerEl };\n\n    this.openClasses = this._buildClasses(\"open\");\n\n    this._buildElement();\n  }\n\n  _buildClasses(suffix) {\n    const classes = [`drift-${suffix}`];\n\n    const ns = this.settings.namespace;\n    if (ns) {\n      classes.push(`${ns}-${suffix}`);\n    }\n\n    return classes;\n  }\n\n  _buildElement() {\n    this.el = document.createElement(\"div\");\n    addClasses(this.el, this._buildClasses(\"bounding-box\"));\n  }\n\n  show(zoomPaneWidth, zoomPaneHeight) {\n    this.isShowing = true;\n\n    this.settings.containerEl.appendChild(this.el);\n\n    const style = this.el.style;\n    style.width = `${Math.round(zoomPaneWidth / this.settings.zoomFactor)}px`;\n    style.height = `${Math.round(zoomPaneHeight / this.settings.zoomFactor)}px`;\n\n    addClasses(this.el, this.openClasses);\n  }\n\n  hide() {\n    if (this.isShowing) {\n      this.settings.containerEl.removeChild(this.el);\n    }\n\n    this.isShowing = false;\n\n    removeClasses(this.el, this.openClasses);\n  }\n\n  setPosition(percentageOffsetX, percentageOffsetY, triggerRect) {\n    const pageXOffset = window.pageXOffset;\n    const pageYOffset = window.pageYOffset;\n\n    let inlineLeft = triggerRect.left + percentageOffsetX * triggerRect.width - this.el.clientWidth / 2 + pageXOffset;\n    let inlineTop = triggerRect.top + percentageOffsetY * triggerRect.height - this.el.clientHeight / 2 + pageYOffset;\n\n    if (inlineLeft < triggerRect.left + pageXOffset) {\n      inlineLeft = triggerRect.left + pageXOffset;\n    } else if (inlineLeft + this.el.clientWidth > triggerRect.left + triggerRect.width + pageXOffset) {\n      inlineLeft = triggerRect.left + triggerRect.width - this.el.clientWidth + pageXOffset;\n    }\n\n    if (inlineTop < triggerRect.top + pageYOffset) {\n      inlineTop = triggerRect.top + pageYOffset;\n    } else if (inlineTop + this.el.clientHeight > triggerRect.top + triggerRect.height + pageYOffset) {\n      inlineTop = triggerRect.top + triggerRect.height - this.el.clientHeight + pageYOffset;\n    }\n\n    this.el.style.left = `${inlineLeft}px`;\n    this.el.style.top = `${inlineTop}px`;\n  }\n}\n"],"file":"BoundingBox.js"}